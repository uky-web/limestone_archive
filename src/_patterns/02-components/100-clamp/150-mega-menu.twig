
{#
  We call a macro which calls itself to render the full tree.
  @see http://twig.sensiolabs.org/doc/tags/macro.html
#}

{{ _self.menu_links(items, 0) }}

{% macro menu_links(items, menu_level) %}
  {% if items %}
      {% for item in items %}
        {%
          set classes = [
            'mega-menu-nav-item',
            'mega-menu__level_1',
            'js-nav-item',
            item.in_active_trail ? 'active-trail',
            item.below ? 'has-submenu'
          ]
        %}
          {% include 'atoms-link-expand-menu' with { label: item.title, classes: classes|join(' ') } %}
          {% if item.below %}
            {{ _self.submenu_links(item.below, menu_level + 1, item.title) }}
          {% endif %}
      {% endfor %}
  {% endif %}
{% endmacro %}

{% macro submenu_links(items, menu_level, title) %}
  <div class="mega-menu__slab">
    <div class="mega-menu__description">
      {% include "atoms-heading" with { headline: title } %}
      {% include "atoms-paragraph" %}
    </div>
    <div class="mega-menu__submenus">
    {% for column in items|batch(7) %}
      <div class="mega-menu__submenu_column">
          {% for item in column %}
            {% include 'atoms-link' with { label: item.title, url: item.url } %}
          {% endfor %}
      </div>
    {% endfor %}
    </div>
  </div>
{% endmacro %}